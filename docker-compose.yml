services:
  trading-bot:
    build: .
    container_name: ai-stock-trader
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
    env_file:
      - .env
    environment:
      - DATABASE_URL=sqlite+aiosqlite:////app/data/trading.db
      - PORTFOLIO_FILE=/app/data/portfolio.json
    # Command line arguments for src.main (entrypoint already runs python -m src.main):
    # (no command) = bot mode only (no web dashboard)
    # --web         = start web dashboard (runs bot analysis + monitoring loop in background)
    # --test-mode   = ignore market hours for testing
    # Examples:
    # command: ["--web"]
    # command: ["--test-mode"]
    command: ["--web", "--restart"]
    restart: unless-stopped
